import { notFound } from "next/navigation";
import styles from "../services.module.css";
import Link from "next/link";
import { FaCheck } from "react-icons/fa";
import { BtnCta } from "@@/components/common/btnCta";
import { ServiceLeadForm } from "@@/components/forms/ServiceLeadForm";

const serviceData = {
  "corporate-sites": {
    title: "Разработка корпоративных сайтов в Ростове-на-Дону от 120 000 ₽",
    shortTitle: "Корпоративные сайты",
    heroDescription: "Разрабатываем корпоративные сайты под ключ: структура, контент, интеграции и SEO. Сайт презентует компанию, повышает доверие и приводит заявки.",
    intro: `Веб-студия ВебШтрих создаёт корпоративные сайты для компаний Ростова-на-Дону и всей России. Мы помогаем презентовать услуги, команду и кейсы, создаём удобные сценарии конверсии, подключаем CRM и аналитику. Каждый сайт строится на основе бизнес-целей, а не шаблонных решений: мы проводим интервью, анализируем нишу и конкурентов, формируем структуру и контент, который отвечает на вопросы клиентов. Уделяем внимание скорости, безопасности и SEO, чтобы сайт был заметен в Яндекс и Google.`,
    benefitsIntro: `За счёт детального анализа и дизайна, адаптированного под бренд, корпоративный сайт работает как главный продающий инструмент. Он повышает доверие, помогает закрывать сделки и поддерживает коммуникацию с клиентами и партнёрами. В проекте учитываем интеграции с CRM, рассылками, онлайн-записью и чатом поддержки.`,
    benefits: [
      "Уникальные посадочные и блочные структуры для подразделений, услуг и кейсов",
      "Интеграции с CRM, календарями, онлайн-записью и аналитикой",
      "SEO-структура и техническая оптимизация под ключевые запросы Ростова-на-Дону",
      "Контент, который объясняет ценность компании простым языком",
      "Возможность масштабирования: новые разделы, личный кабинет, мультиязычность",
    ],
    stages: [
      {
        title: "Аналитика и стратегия",
        text: "Проводим интервью с руководителями и маркетологами, анализируем конкурентов и запросы. Формируем структуру сайта, определяем ключевые страницы и точки контакта с клиентами. Готовим дорожную карту по SEO и маркетингу, чтобы сайт с первого дня получал трафик."
      },
      {
        title: "Контент и прототип",
        text: "Создаём интерактивный прототип: показываем расположение блоков, сценарии пользователя, формы заявок. Параллельно готовим тексты и визуальные материалы, которые продают услуги и показывают компетенции команды."
      },
      {
        title: "Дизайн, разработка и интеграции",
        text: "Создаём дизайн-систему, верстаем адаптивные страницы, подключаем CMS (при необходимости), внедряем интеграции с CRM, сервисами аналитики и безопасности. Проводим оптимизацию по Core Web Vitals."
      },
      {
        title: "Тестирование и запуск",
        text: "Проверяем сайт на всех устройствах, тестируем формы, интеграции и скорость. Подготавливаем домен, хостинг, SSL-сертификат, настраиваем редиректы, карты сайта и файлы robots."
      },
      {
        title: "Поддержка и рост",
        text: "Сопровождаем проект после запуска: обновляем разделы, добавляем кейсы и новости, настраиваем SEO-кампании, ведём аналитику. Помогаем внедрить новые функции — от личного кабинета до интеграций с внутренними системами."
      },
    ],
    cases: [
      {
        name: "Корпоративный сайт производителя оборудования",
        result: "Увеличили органический трафик на 40% за 3 месяца",
        description: "Разработали структуру каталога, внедрили онлайн-заявки и интеграцию с Bitrix24. Настроили SEO и контент-маркетинг."
      },
      {
        name: "Сервисный центр в Ростове-на-Дону",
        result: "Рост заявок с сайта на 55% после редизайна",
        description: "Создали дизайн, который подчёркивает экспертность команды, добавили раздел FAQ и отзывы клиентов, интегрировали онлайн-запись."
      }
    ],
    faq: [
      { question: "Сколько стоит корпоративный сайт под ключ?", answer: "Стоимость стартует от 120 000 ₽ и зависит от количества страниц, интеграций и необходимости в мультиязычности. Мы составляем расчёт после анализа целей и структуры." },
      { question: "Сколько времени занимает запуск?", answer: "Средний срок — 7–10 недель: 1,5 недели аналитики, 2 недели на прототип и дизайн, 3–4 недели на разработку и тестирование. Дополнительные интеграции могут продлить срок." },
      { question: "Можно ли подключить CMS или личный кабинет?", answer: "Да. Подбираем CMS под задачи (Headless, WordPress, Strapi и др.) или реализуем кастомный кабинет на Next.js с авторизацией и ролями." },
      { question: "Готовите ли тексты и фотографии?", answer: "Да. Мы работаем с копирайтерами и дизайнерами, проводим фото- и видеосъёмку, подготавливаем иллюстрации, чтобы контент выглядел профессионально." },
      { question: "Берёте ли поддержку после запуска?", answer: "Да. Предлагаем пакетную поддержку: обновление контента, технический мониторинг, SEO, внедрение новых разделов и функций." }
    ],
    price: "от 120 000 ₽",
    timeline: "7–10 недель",
    leadMagnet: "Бесплатный аудит корпоративного сайта и план роста на 3 месяца",
    seo: {
      title: "Разработка корпоративных сайтов в Ростове-на-Дону | ВебШтрих",
      description: "Корпоративные сайты под ключ в Ростове-на-Дону: аналитика, дизайн, разработка, SEO и интеграции. Стоимость от 120 000 ₽, запуск за 7–10 недель.",
      keywords: "разработка корпоративного сайта Ростов-на-Дону, корпоративный сайт под ключ, создать сайт компании Ростов"
    }
  },
  "ecommerce": {
    title: "Создание интернет-магазина в Ростове-на-Дону под ключ",
    shortTitle: "Интернет-магазины",
    heroDescription: "Запускаем интернет-магазины с нуля: каталог, оплата, доставка, CRM и маркетинг. Магазин готов к продажам с первого дня.",
    intro: `Мы проектируем интернет-магазины для нишевого и массового бизнеса. Изучаем ассортимент, логистику, способы оплаты, готовим структуру каталога и сценарии покупки. Создаём адаптивный интерфейс, благодаря которому заказы удобно оформлять с телефона. Подключаем CRM, сторонние сервисы и автоматизацию маркетинга, чтобы увеличивать средний чек и повторные продажи.`,
    benefitsIntro: `Интернет-магазин ВебШтрих — это платформа роста. Он интегрирован с учётом, доставкой, маркетплейсами и рекламой, чтобы вы контролировали продажи в одном месте.`,
    benefits: [
      "Структурированные каталоги, фильтры, карточки товара с SEO-текстами",
      "Интеграции с 1C, МойСклад, CRM, сервисами доставки и оплаты",
      "Программы лояльности, бонусы, промокоды и upsell-блоки",
      "Отчётность и аналитика: конверсия, средний чек, ROMI",
      "Подготовка к продвижению: SEO-структура, микроразметка, быстрая скорость",
    ],
    stages: [
      {
        title: "Бриф и аналитика",
        text: "Собираем информацию о товарах, поставщиках, маржинальности и целевой аудитории. Формируем карту категорий, карточек и SEO-запросов."
      },
      {
        title: "Прототип и контент",
        text: "Продумываем сценарии фильтрации и покупки, делаем прототипы главных страниц, подбираем тексты и медиа."
      },
      {
        title: "Дизайн и разработка",
        text: "Создаём UI, верстаем и программируем функционал: корзина, личный кабинет, уведомления, интеграции с платёжными и логистическими сервисами."
      },
      {
        title: "Интеграции и тестирование",
        text: "Подключаем склад, CRM, рассылки, сквозную аналитику. Проводим тесты кошельков, карт, наличных и самовывоза."
      },
      {
        title: "Запуск и маркетинг",
        text: "Готовим техническую документацию, обучаем менеджеров, запускаем SEO и рекламные кампании, чтобы магазин быстро начал продавать."
      }
    ],
    cases: [
      {
        name: "Магазин матрасов",
        result: "+27% продаж за 2 недели",
        description: "Реализовали корзину с шагами, интеграцию с 1C и рассылками. Настроили акции и upsell." }
    ],
    faq: [
      { question: "Какая стоимость запуска?", answer: "Стоимость от 180 000 ₽. Включает аналитику, дизайн, разработку, интеграции. Дополнительные функции рассчитываем отдельно." },
      { question: "Какой движок используете?", answer: "Работаем на Next.js + Headless CMS или подключаем готовые CMS (Shopify, Bitrix) — выбор зависит от задач и масштаба." },
      { question: "Можете подключить маркетплейсы?", answer: "Да. Строим интеграции с Ozon, Wildberries, Яндекс.Маркет через API или готовые коннекторы." },
      { question: "Есть ли обучение персонала?", answer: "Проводим обучение менеджеров и администраторов магазинов, готовим инструкцию и видео по работе с системой." },
      { question: "Поможете с рекламой?", answer: "Да. Настраиваем рекламу в Яндекс, VK, Telegram, а также запускаем email-рассылки и push-уведомления." }
    ],
    price: "от 180 000 ₽",
    timeline: "6–12 недель",
    leadMagnet: "Получите чек-лист по запуску интернет-магазина за 14 дней",
    seo: {
      title: "Создание интернет-магазина в Ростове-на-Дону | ВебШтрих",
      description: "Интернет-магазины под ключ: каталог, оплата, доставка, CRM. Запуск за 6–12 недель. Продажи с первого дня.",
      keywords: "создание интернет-магазина Ростов, интернет-магазин под ключ, e-commerce разработка Ростов"
    }
  },
  "web-apps": {
    title: "Разработка веб-приложений в Ростове-на-Дону",
    shortTitle: "Веб-приложения",
    heroDescription: "Проектируем и разрабатываем веб-приложения для автоматизации процессов, SaaS-платформы и личные кабинеты.",
    intro: `Мы создаём кастомные веб-приложения для бизнеса, стартапов и корпораций. Анализируем бизнес-процессы, проектируем архитектуру, создаём интерфейсы и реализуем API-интеграции. Приложения работают в браузере и адаптированы под мобильные устройства, обеспечивают безопасность и масштабируемость.`,
    benefitsIntro: `Разрабатываем решения, которые снижают ручной труд, ускоряют обслуживание клиентов и дают прозрачную аналитику.`,
    benefits: [
      "Архитектура под нагрузку и рост",
      "Интеграции с внутренними системами и сторонними сервисами",
      "Удобный UI/UX для сотрудников, партнёров и клиентов",
      "Роли и права доступа, шифрование данных, резервное копирование",
      "План развития и техническое сопровождение",
    ],
    stages: [
      { title: "Discovery", text: "Проводим интервью, описываем процессы, определяем MVP и roadmap." },
      { title: "Прототип и архитектура", text: "Создаём CJM, прототипы экранов, проектируем базы данных и API." },
      { title: "Разработка и тесты", text: "Реализуем функционал итерациями, автоматизируем тестирование, внедряем DevOps-процессы." },
      { title: "Запуск", text: "Разворачиваем приложение в облаке или на серверах клиента, настраиваем мониторинг и резервирование." },
      { title: "Поддержка", text: "Отслеживаем метрики, дорабатываем функционал, готовим обновления и масштабирование." }
    ],
    cases: [
      { name: "B2B платформа", result: "Сократили время обработки заявки с 2 дней до 3 часов", description: "Реализовали личные кабинеты партнёров, интеграции с CRM и аналитику в реальном времени." }
    ],
    faq: [
      { question: "Во сколько обходится разработка?", answer: "Стоимость от 200 000 ₽. Итоговая цена зависит от сложности, числа модулей, интеграций и требований к безопасности." },
      { question: "Какие технологии используете?", answer: "Next.js, React, TypeScript, Node.js, PostgreSQL, GraphQL, NestJS. Подбираем стек под нагрузку и интеграции." },
      { question: "Какова длительность проекта?", answer: "MVP готовим за 8–12 недель. Полнофункциональные продукты могут занимать 4–6 месяцев, при этом работаем по Agile." },
      { question: "Сможем ли мы сами развивать приложение?", answer: "Да. Передаем документацию, структуру репозитория и обучаем вашу команду. При необходимости остаёмся на поддержке." },
      { question: "Как обеспечивается безопасность?", answer: "Используем JWT, шифрование данных, аудит логов, тесты на уязвимости, настраиваем резервные копии и мониторинг." }
    ],
    price: "от 200 000 ₽",
    timeline: "8–16 недель",
    leadMagnet: "Закажите консультацию по архитектуре веб-приложения",
    seo: {
      title: "Разработка веб-приложений в Ростове-на-Дону | ВебШтрих",
      description: "Кастомные веб-приложения, SaaS и личные кабинеты. Аналитика, архитектура, разработка и поддержка.",
      keywords: "разработка веб-приложений Ростов, SaaS разработка, автоматизация бизнеса Ростов"
    }
  },
  "seo": {
    title: "SEO-продвижение сайтов в Ростове-на-Дону",
    shortTitle: "SEO-продвижение",
    heroDescription: "Комплексное SEO: аудит, оптимизация, контент и линкбилдинг. Повышаем видимость и приводим целевой трафик.",
    intro: `SEO-команда ВебШтрих выводит сайты в топ Яндекса и Google. Проводим аудит, правим технические ошибки, собираем семантическое ядро и формируем контент-план. Настраиваем отчётность, чтобы вы видели рост трафика, позиций и заявок.`,
    benefitsIntro: `Работаем по принципу "результат, а не отчёт". Каждую гипотезу подтверждаем цифрами, оптимизируем бюджет и показываем реальные заявки.`,
    benefits: [
      "Технический аудит и исправление ошибок",
      "Формирование и кластеризация семантики",
      "Контент-план, копирайтинг и оптимизация",
      "Работа с коммерческими факторами",
      "Линкбилдинг и outreach",
      "Подключение сквозной аналитики",
    ],
    stages: [
      { title: "Аналитика", text: "Изучаем текущие позиции, конкурентов, собираем семантику." },
      { title: "Техническая оптимизация", text: "Исправляем ошибки, ускоряем сайт, внедряем микроразметку." },
      { title: "Контент и коммерческие факторы", text: "Готовим SEO-тексты, усиливаем доверие через отзывы и кейсы." },
      { title: "Внешние факторы", text: "Выстраиваем ссылочный профиль, работаем с упоминаниями и партнёрскими площадками." },
      { title: "Аналитика и развитие", text: "Ведём регулярные отчёты, корректируем стратегию, внедряем новые воронки." }
    ],
    cases: [
      { name: "Услуги b2b", result: "+40% органического трафика за 3 месяца", description: "Настроили SEO-фундамент, внедрили структуру и коммерческие факторы." }
    ],
    faq: [
      { question: "Когда будут результаты?", answer: "Первые сдвиги наблюдаем через 1–1,5 месяца: рост позиций по низкочастотным запросам, увеличение заявок из органики. Стабильный рост — через 3–6 месяцев." },
      { question: "Какая стоимость?", answer: "Абонентская плата от 60 000 ₽. Включает аудит, техническое SEO, контент и ссылочные работы." },
      { question: "Работаете с молодыми сайтами?", answer: "Да. Формируем стратегию продвижения с учётом песочницы, упор делаем на контент и коммерческие факторы." },
      { question: "Давайте ли доступ к отчётам?", answer: "Формируем дашборд с ключевыми метриками в Google Data Studio и присылаем сводки раз в неделю." },
      { question: "Гарантируете ли топ-1?", answer: "Мы гарантируем прозрачность и измеримый рост. Точные позиции зависят от конкуренции и алгоритмов, но мы опираемся на опыт и данные." }
    ],
    price: "от 60 000 ₽",
    timeline: "от 3 месяцев",
    leadMagnet: "Закажите SEO-аудит сайта и список правок",
    seo: {
      title: "SEO-продвижение сайтов в Ростове-на-Дону | ВебШтрих",
      description: "Комплексный SEO-сопровождение: аудит, внедрение, контент и ссылки. От 60 000 ₽ в месяц.",
      keywords: "SEO продвижение Ростов-на-Дону, SEO агентство Ростов, вывод сайта в топ Ростов"
    }
  },
  "marketing": {
    title: "Реклама и перформанс-маркетинг в Ростове-на-Дону",
    shortTitle: "Маркетинг и реклама",
    heroDescription: "Запускаем перформанс-кампании в Яндекс, VK, Telegram и других каналах. Обеспечиваем поток заявок и продаж.",
    intro: `ВебШтрих берёт на себя перформанс-маркетинг: подготавливаем стратегию, креативы, лендинги, подключаем аналитику, запускаем рекламу и оптимизируем её для повышения прибыли. Работаем с b2b и b2c проектами, строим комплексные воронки и автоматизацию.`,
    benefitsIntro: `Комбинируем платные и органические каналы, чтобы вы получали заявки из Яндекс.Директ, VK Рекламы, Telegram, e-mail и ретаргетинга.`,
    benefits: [
      "Стратегия продвижения на 3–6 месяцев",
      "Подготовка креативов, лендингов и квизов",
      "Запуск и оптимизация PPC-кампаний",
      "Настройка аналитики и автоматизации",
      "A/B-тесты и регулярные отчёты",
    ],
    stages: [
      { title: "Стратегия", text: "Определяем аудиторию, офферы, бюджет и KPI." },
      { title: "Подготовка", text: "Создаём креативы, лендинги, квизы, настраиваем аналитику." },
      { title: "Запуск", text: "Настраиваем кампании в Яндекс, VK, Telegram, myTarget, Google Ads (при необходимости)." },
      { title: "Оптимизация", text: "Анализируем данные, отключаем неэффективные связки, усиливаем лучшие." },
      { title: "Масштабирование", text: "Добавляем новые каналы, запускаем автоматические воронки и e-mail маркетинг." }
    ],
    cases: [
      { name: "Образовательный проект", result: "Снизили CPL на 32%", description: "Внедрили квизы, оптимизировали ключевые слова и ретаргетинг." }
    ],
    faq: [
      { question: "Сколько стоит маркетинговое сопровождение?", answer: "От 70 000 ₽ в месяц + рекламный бюджет. Итоговая цена зависит от количества каналов и подготовительных работ." },
      { question: "Вы готовите креативы и лендинги?", answer: "Да. Команда дизайнеров и копирайтеров создаёт креативы, баннеры, видео. При необходимости делаем посадочные страницы." },
      { question: "Работаете ли с текущими рекламными кампаниями?", answer: "Проводим аудит, оптимизируем и переупаковываем кампании для снижения CPL." },
      { question: "Как показываете эффективность?", answer: "Настраиваем сквозную аналитику, передаем данные в CRM, формируем отчёты с KPI, ROMI, CPA." },
      { question: "Можно ли начать с тестового месяца?", answer: "Да. Формируем тестовую стратегию на 30 дней, чтобы вы оценили нашу работу и результаты." }
    ],
    price: "от 70 000 ₽",
    timeline: "от 1 месяца",
    leadMagnet: "Получите медиаплан и прогноз по заявкам",
    seo: {
      title: "Реклама и перформанс-маркетинг в Ростове-на-Дону | ВебШтрих",
      description: "Запуск рекламы в Яндекс, VK, Telegram, экспертиза по перформансу. Приводим заявки уже в первый месяц.",
      keywords: "реклама сайтов Ростов, перформанс маркетинг Ростов, таргетированная реклама Ростов"
    }
  }
};


export async function generateMetadata({ params }) {
  const { id } = params; // Получаем id из URL
  const service = serviceData[id];

  // Если кейс не найден, показываем 404
  if (!service) {
    notFound();
  }

  return {
    title: service.seo?.title ?? `Услуга — ${service.title} | ВебШтрих`,
    description: service.seo?.description ?? service.description,
    keywords: service.seo?.keywords,
    alternates: {
      canonical: `https://webstroke.ru/services/${id}`,
    },
    openGraph: {
      title: service.seo?.title ?? service.title,
      description: service.seo?.description ?? service.description,
      images: [
        {
          url: "/img/logo.png",
          width: 1200,
          height: 630,
          alt: service.title,
        },
      ],
    },
  };
}


export default function ServiceDetail({ params }) {
  const service = serviceData[params.id];

  if (!service) {
    notFound();
  }

  const otherServices = Object.entries(serviceData)
    .filter(([key]) => key !== params.id)
    .map(([key, data]) => ({ key, ...data }));

  return (
    <div className={ styles.servicePage }>
      <section className={ styles.hero }>
        <div className={ styles.heroContent }>
          <h1>{ service.title }</h1>
          <p className={ styles.heroDescription }>{ service.heroDescription }</p>
          <div className={ styles.heroCta }>
            <BtnCta text="Обсудить проект" href="/#contact" />
            <div className={ styles.heroGuarantee }>
              <FaCheck /> Ответим в течение одного дня
            </div>
          </div>
        </div>
      </section>

      <section className={ styles.richIntro }>
        <div className={ styles.richText }>
          <p>{ service.intro }</p>
          <p>{ service.benefitsIntro }</p>
        </div>
        <ul className={ styles.highlightList }>
          { service.benefits.map((item, idx) => (
            <li key={ idx }>{ item }</li>
          )) }
        </ul>
      </section>

      <section className={ styles.workSteps }>
        <h2>Этапы работы</h2>
        <p className={ styles.sectionSubtitle }>Чёткий план, который гарантирует предсказуемый результат</p>
        <div className={ styles.stepsContainer }>
          { service.stages.map((stage, idx) => (
            <div key={ stage.title } className={ styles.step }>
              <div className={ styles.stepNumber }>{ idx + 1 }</div>
              <h3>{ stage.title }</h3>
              <p>{ stage.text }</p>
            </div>
          )) }
        </div>
      </section>

      { service.cases?.length > 0 && (
        <section className={ styles.caseStudies }>
          <h2>Кейсы и результаты</h2>
          <div className={ styles.caseGrid }>
            { service.cases.map((caseItem) => (
              <div key={ caseItem.name } className={ styles.caseCard }>
                <h3>{ caseItem.name }</h3>
                <p className={ styles.caseResult }>{ caseItem.result }</p>
                <p>{ caseItem.description }</p>
              </div>
            )) }
          </div>
        </section>
      ) }

      <section className={ styles.pricing }>
        <div className={ styles.pricingCard }>
          <h2>Стоимость и сроки</h2>
          <div className={ styles.priceTag }>{ service.price }</div>
          <div className={ styles.timeline }>Средний срок реализации: { service.timeline }</div>
          <div className={ styles.valueProps }>
            <p><FaCheck /> Бесплатный созвон и оценка</p>
            <p><FaCheck /> План внедрения на 90 дней</p>
            <p><FaCheck /> Поддержка после запуска</p>
          </div>
        </div>
        <div className={ styles.formWrapper }>
          <ServiceLeadForm serviceName={ service.shortTitle } />
        </div>
      </section>

      { service.faq?.length > 0 && (
        <section className={ styles.faq }>
          <h2>Ответы на вопросы</h2>
          <div className={ styles.faqList }>
            { service.faq.map((item) => (
              <details key={ item.question } className={ styles.faqItem }>
                <summary>{ item.question }</summary>
                <p>{ item.answer }</p>
              </details>
            )) }
          </div>
        </section>
      ) }

      <section className={ styles.finalCta }>
        <h2>Получите { service.leadMagnet }</h2>
        <p>Заполните короткую форму — подготовим персональный план и расчёт в течение 24 часов.</p>
        <BtnCta text="Хочу консультацию" href="/#contact" size="large" />
      </section>

      <section className={ styles.otherServices }>
        <h2>Другие услуги</h2>
        <div className={ styles.servicesGrid }>
          { otherServices.map((s) => (
            <Link key={ s.key } href={ `/services/${s.key}` } className={ styles.serviceCard }>
              <h3>{ s.shortTitle ?? s.title }</h3>
              <p>{ s.heroDescription }</p>
              <span className={ styles.servicePrice }>{ s.price }</span>
            </Link>
          )) }
        </div>
      </section>
    </div>
  );
}
