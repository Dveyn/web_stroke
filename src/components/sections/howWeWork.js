"use client";
import React, { useEffect } from 'react';
import { motion } from "framer-motion";
import { FaSearch, FaDraftingCompass, FaPalette, FaCode, FaBug, FaRocket } from "react-icons/fa";
import aosInit from '@@/utils/aosInit';
import "../../styles/globals.css";

const steps = [
  {
    icon: <FaSearch />,
    title: "Знакомство и ваши цели",
    description: "На первом этапе вы делитесь историей компании в Ростове-на-Дону, продуктами, аудиторией и ожиданиями. Мы проводим экспресс-анализ ниши, изучаем конкурентов и определяем ключевые запросы, по которым сайт будет находить ваша ЦА. Например, для кафе в центре города предлагаем подключить онлайн-бронирование и доставку, а для сервисного бизнеса — форму быстрой заявки и интеграцию с CRM, чтобы не терять обращения.",
    bullets: [
      "Анализируем текущие каналы привлечения и веб-активы",
      "Собираем ключевые запросы по Ростову-на-Дону",
      "Фиксируем цели: лиды, продажи, узнаваемость",
    ],
  },
  {
    icon: <FaDraftingCompass />,
    title: "План и предложение",
    description: "Формируем детальный план разработки: описываем этапы, сроки и стоимость, закрепляем всё в коммерческом предложении. Предлагаем несколько пакетов — от стартового до премиум — чтобы вы могли выбрать решение под бюджет. Прозрачность — наш приоритет: фиксированные платежи, поэтапная оплата и контрольные точки, на которых вы утверждаете концепцию, прототип и дизайн будущего сайта или интернет-магазина.",
    bullets: [
      "Готовим структуру страниц и карту сервиса",
      "Назначаем дедлайны и ответственных",
      "Обсуждаем SEO и маркетинг на старте",
    ],
  },
  {
    icon: <FaPalette />,
    title: "Дизайн под ваш бренд",
    description: "На основе утверждённого ТЗ создаём уникальный прототип и визуальную концепцию. Учитываем фирменные цвета, тон коммуникации и брендбук, чтобы сайт выглядел профессионально и внушал доверие. Проверяем, как страницы отображаются на смартфонах, планшетах и десктопах, закладываем удобные сценарии конверсии и микровзаимодействия. Все макеты согласовываем поэтапно: вы видите, как живёт будущий интерфейс, и вносите правки до верстки.",
    bullets: [
      "Подготавливаем интерактивный прототип",
      "Настраиваем дизайн-систему и UI-кит",
      "Проверяем UX на мобильных и десктопах",
    ],
  },
  {
    icon: <FaCode />,
    title: "Разработка и интеграции",
    description: "Разрабатываем сайт на современном стеке: Next.js, React, TypeScript. Соблюдаем требования по скорости, безопасности и SEO. Подключаем формы заявок, онлайн-оплату (Сбербанк, Тинькофф, ЮKassa), CRM-системы (Bitrix24, amoCRM), сервисы аналитики и уведомлений. Для интернет-магазинов настраиваем складской учет и интеграцию с 1C, а для корпоративных порталов — личные кабинеты сотрудников или партнёров.",
    bullets: [
      "Верстаем адаптивные страницы",
      "Подключаем CRM, оплату и аналитику",
      "Оптимизируем скорость и безопасность",
    ],
  },
  {
    icon: <FaBug />,
    title: "Тестирование и запуск",
    description: "Перед релизом прогоняем проект по чек-листу: кроссбраузерность, адаптивность, проверка форм, корректность интеграций и SEO-метрик. Используем Lighthouse и PageSpeed Insights, чтобы показатель Core Web Vitals был в зоне зелёного. После согласования переносим сайт на ваш домен и хостинг, настраиваем 301-редиректы, SSL, sitemap и robots. Запуск происходит только после того, как вы лично убедитесь в готовности.",
    bullets: [
      "Тестируем на реальных устройствах",
      "Проверяем Core Web Vitals",
      "Готовим документацию и инструкции",
    ],
  },
  {
    icon: <FaRocket />,
    title: "Поддержка и рост",
    description: "После релиза продолжаем сопровождение: мониторим позиции в поиске, подключаем SEO- и рекламные кампании, анализируем конверсию по каналам. Обновляем контент, загружаем новые кейсы, внедряем функции по обратной связи, проводим A/B-тесты. За счёт регулярной оптимизации вы получаете устойчивый поток заявок и клиентов из Ростова-на-Дону и других регионов.",
    bullets: [
      "Настраиваем SEO и рекламу",
      "Отслеживаем показатели в аналитике",
      "Планируем релизы улучшений",
    ],
  },
];

const HowWeWork = () => {
  useEffect(() => {
    aosInit();
  }, []);

  return (
    <section id="how-we-work" className="section">
      <motion.div
        initial={ { opacity: 0, y: 20 } }
        whileInView={ { opacity: 1, y: 0 } }
        transition={ { duration: 0.8 } }
        viewport={ { once: true } }
      >
        <h2>Как мы работаем?</h2>
        <p className="section-subtitle">
          Прозрачный процесс от заявки до запуска
        </p>
      </motion.div>

      <div className="how-we-work-container">
        <div className="timeline"></div>
        <div className="how-we-work-grid">
          { steps.map((step, index) => (
            <StepCard key={ index } index={ index } step={ step } />
          )) }
        </div>
      </div>
    </section>
  );
};

const StepCard = ({ index, step }) => {
  return (
    <motion.div
      className={ `how-we-work-card ${index % 2 === 0 ? "left" : "right"}` }
      initial={ { opacity: 0, x: index % 2 === 0 ? -50 : 50 } }
      whileInView={ { opacity: 1, x: 0 } }
      transition={ { duration: 0.6, delay: index * 0.2 } }
      viewport={ { once: true } }
      whileHover={ { scale: 1.02 } }
    >
      <div className="how-we-work-icon">{ step.icon }</div>
      <h3>{ step.title }</h3>
      <p>{ step.description }</p>
      { step.bullets && (
        <ul className="how-we-work-list">
          { step.bullets.map((item, i) => (
            <li key={ i }>{ item }</li>
          )) }
        </ul>
      ) }
    </motion.div>
  );
};

export default HowWeWork;
